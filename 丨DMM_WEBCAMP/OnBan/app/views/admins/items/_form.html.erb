<!-- 新規登録と編集で登録ボタンを押した時のURLを三項演算子でそれぞれに分岐させています -->
<%# urlがidをもたなければ(nil)新規登録(admins_items_path)、idを持つ場合は編集(admins_item_path(id: @item.id)) %>
<%= form_for(@item, url: @item.id == nil ? admins_items_path : admins_item_path(id: @item.id)) do |f| %>
  <% if @item.errors.any? %>
    <div class="alert alert-warning" role="alert">
      <h4><%= @item.errors.count %>件のerrorがあります。</h4>
      <ul>
        <% @item.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="form-group">
    <label>CDタイトル</label>
    <%= f.text_field :item_name, size: 60; %>
  </div>
  <div class="form-group">
    <label>レーベル</label>
    <%# :include_blank => ""でplaceholderを設定 %>
    <%= f.collection_select :label_id, Label.all.order("label_name"), :id, :label_name, :include_blank => "レーベルを選択" %>
  </div>
  <div class="form-group">
    <label>ジャンル</label>
    <%= f.collection_select :category_id, Category.all.order("category_name"), :id, :category_name, :include_blank => "ジャンルを選択" %>
  </div>
  <div class="form-group">
    <label>アーティスト</label>
    <%= f.collection_select :artist_id, Artist.all.order("artist_name"), :id, :artist_name, :include_blank => "アーティストを選択" %>
  </div>
  <div class="form-group">
    <label>ジャケット画像</label>
    <div style="width: 200px; margin: 10px auto;"><%= f.attachment_field :image, placeholder: "画像を選択" %>
    </div>
  </div>
  <div class="form-group">
    <label>価格(税抜)</label>
    <%= f.number_field :item_price %>
  </div>
　<div class="form-group">
    <label>在庫数</label>
    <%= f.number_field :stocks %>
  </div>
　<div class="form-group">
    <label>販売状況ステータス</label>
    <%# enumを使っていますが、f.number_fielsだとformの戻り値がintegerでなくstringなのでエラーになります %>
    <%= f.select(:item_status, {販売中: '販売中', 販売停止: '販売停止'}, :include_blank => "販売状況を選択") %>
  </div>
  <%# 子テーブルの入力欄 %>
  <div id="discs">
    <%# 登録フォームはパーシャル %>
    <%= f.fields_for :discs do |disc| %>
      <%= render 'disc_fields', f: disc %>
    <% end %>
    <div id="links" style="margin: 15px;">
      <%# cocoonにより動的に入力フォームを追加 %>
      <%= link_to_add_association 'ディスク入力欄を追加', f, :discs, class: "btn btn-success btn-sm" %>
    </div>
    <div style="margin-top: 80px;"><%= f.submit '登録', class: "btn btn-info btn-lg" %>
    </div>
  </div>
<% end %>